## 错误信息打印类

```java
public class ExceptionUtils {

    public static String getMessage(Exception e) {
        StringWriter sw = null;
        PrintWriter pw = null;
        try {
            sw = new StringWriter();
            pw = new PrintWriter(sw);
            // 将出错的栈信息输出到printWriter中
            e.printStackTrace(pw);
            pw.flush();
            sw.flush();
        } finally {
            if (sw != null) {
                try {
                    sw.close();
                } catch (IOException e1) {
                    e1.printStackTrace();
                }
            }
            if (pw != null) {
                pw.close();
            }
        }
        return sw.toString();
    }
}
```

## 异常处理器

```java
package com.learn.serveceBase.exceptionHandler;

import com.learn.serveceBase.exceptionHandler.exception.LoginException;
import com.learn.slsun.exception.ExceptionUtils;
import com.learn.slsun.result.R;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.ResponseBody;

/**
 * @author slsun
 * @version 1.0
 * @title: GlobalExceptionHandler
 * @description //TODO 错误处理种类$
 * @date: 2021/7/8 16:10
 */

@ControllerAdvice
@Slf4j
public class GlobalExceptionHandler {

  

    // 自定义的异常处理
    @ExceptionHandler(GloblaException.class)
    @ResponseBody // 为了返回数据
    public R error(GloblaException e) {

        // 下面几个错误信息打印，是是一步一步总结往好处发展的 
        // e.printStackTrace();
        // log.error(e.getMessage());
        log.error(ExceptionUtils.getMessage(e));

        return R.error()
                .code(e.getCode())
                .message(e.getMessage());
    }

}

```

## 自定义异常

```java
@Data
public class GlobalException extends RuntimeException {

    private Integer code;

    //当没有自定一个一个返回状态类的时候使用
    public GlobalException(String message, Integer code) {
        super(message);
        this.code = code;
    }
	
    // 自定义的状态码类
    public GlobalException(ResultCodeEnum resultCodeEnum) {
        super(resultCodeEnum.getMessage());
        this.code = resultCodeEnum.getCode();
    }

    @Override
    public String toString() {
        return "GuliException{" +
                "code=" + code +
                ", message=" + this.getMessage() +
                '}';
    }


}
```

## 其他异常类

```java
@ControllerAdvice
@Slf4j
public class GlobalExceptionHandler {

    @ExceptionHandler(Exception.class)
    @ResponseBody
    public R error(Exception e){
//        e.printStackTrace();
        log.error(ExceptionUtils.getMessage(e));
        return R.error();
    }

    @ExceptionHandler(BadSqlGrammarException.class)
    @ResponseBody
    public R error(BadSqlGrammarException e){
        log.error(ExceptionUtils.getMessage(e));
        return R.setResult(ResultCodeEnum.BAD_SQL_GRAMMAR);
    }

    @ExceptionHandler(HttpMessageNotReadableException.class)
    @ResponseBody
    public R error(HttpMessageNotReadableException e){
        log.error(ExceptionUtils.getMessage(e));
        return R.setResult(ResultCodeEnum.JSON_PARSE_ERROR);
    }



    @ExceptionHandler(GuliException.class)
    @ResponseBody
    public R error(GuliException e){
        log.error(ExceptionUtils.getMessage(e));
        return R.error().message(e.getMessage()).code(e.getCode());
    }
}
```

## 使用

```java
throw new GuliException(ResultCodeEnum.FETCH_USERINFO_ERROR);
```

