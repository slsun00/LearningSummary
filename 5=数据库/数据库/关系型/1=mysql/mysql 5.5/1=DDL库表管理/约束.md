## 常见约束

### 含义

*   一种限制，用于限制表中的数据，为了保证表中数据的准确和可靠性

### 关键词分类

* 主键约束   ：primary key  :
* 非空约束    ： not null 
* 唯一约束     ： unique 
* 外键约束     ：foreing key
* ========================
    * 用于限制两个表的关系，用于保证该字段的值必须来自主表的关联列的值。在从表添加外键约束，用于引用主表某列的值
* 检查约束     ： check
    * （mysql不支持，使用不报错）
* 默认约束
    * 保证该字段有默认值



### 添加约束

|                | 列级约束                                         | 表级约束                   |
| -------------- | ------------------------------------------------ | -------------------------- |
|                | 正常写                                           | constraint                 |
| 位置           | 字段后面                                         | 所有列的下面               |
| 支持的约束类型 | 语法上都支持，但是外键约束没有效果               | 除了非空、默认，其他都支持 |
| 起约束名       | 不可以                                           | 可以，对主键无效           |
| 使用           | 一个字段可以追加多个，中间用空格断开，无顺序要求 |                            |
| 添加时机       | 创建表+创建后                                    | 创建表+创建后              |



## 非空约束

```mysql
介绍
	非空，用于保证该字段的值不能为空
添加
	# 创建表的时候添加
    create table stu (
        -- 列级约束
        name varChar(20) not nuill;
        -- 表级约束
        不存在
    )
    # 创建只有添加
    alter table stu modify name varchar(20) not null;
删除
alter table stu modify name varchar(20);
```



## 唯一约束

```mysql
介绍
	唯一，用于保证该字段具有唯一性。可以为空
	限定的列的值可以有多个 null * 唯一，用于保证该字段具有唯一性。可以为空

添加
	# 创建表的时候添加
    create table stu (
        -- 列级约束
        name varChar(20) unique;
        -- 表级约束
        constraint up unique(seat) #设置表级唯一键
    )
    # 创建只有添加
    alter table stu modify name varchar(20) unique;
删除
	alter table stu drop index name varchar(20);
```



## 主键约束

```mysql
介绍
	非空. 唯一
	一张表只能有一个字段作为主键， 是这个表的唯一标识

添加
	# 创建表的时候添加
    create table stu (
        -- 列级约束
        name varChar(20) primary;
        -- 表级约束
        constraint pk primary key(id)#设置表级主键
    )
    # 创建只有添加
    alter table stu modify name varchar(20) primary key;
删除
alter table stu drop primary key;
```



* 与唯一区别

    

    |      | 唯一性 | 是否为空 | 一个表有几个 | 是否可以组合   |
    | ---- | ------ | -------- | ------------ | -------------- |
    | 主键 | √      | ×        | 至多1个      | 可以，但不推荐 |
    | 唯一 | √      | √        | 可以有多个   | 可以，但不推荐 |

## 外键约束

### 介绍

```mysql
介绍
	用于限制两个表的关系，从表的字段值引用了主表的某字段值
位置设置
	-- a 表引用 b 表的内容， a 是从表
	在从表设置外键关系
数据操作
    插入数据时，  先插入主表，	在插入从表
    删除数据，	先删除从表，	在删除主表
添加
	# 创建表的时候添加
    create table stu (
		外键列1
         constraint 外键名 foreign key (外键列1) references 主表名称(主表列名称)；
        -- 表级约束
        constraint pk primary key(id)#设置表级主键
    )
    # 创建只有添加
    alter table stu modify name varchar(20)  constraint 外键名 foreign key (外键列1) references 主表名称(主表列名称)；
删除
alter table stu drop foreing key 外键列1
```

### 级联操作

```mysql
# 级联更新
外键添加字句  on update cascade;

# 级联删除
	-- 删除主表数据 ，从表也会删除
    方式一：级联删除
    外键添加子句 on delete cascade;
    方式二：级联置空
    外键添加子句 on delete set null

# ??

2. 可以加入的数目
    可以加入数目不限制，顺序也不限制。
3. 慎重使用，因为删除一个就会删除好多个，也可能不是你想要的结果
```









### 例子

#### 创建表添加

```mysql

create table stuinfo(
	id int primary key,#设置列级约束主键,
    stuName varchar(20) not null #设置列级约束 非空
    gender char(1) check(gender='男' or gender='女') #设计列级约束检查
    age int default 18 #设置列级约束默认
    majorId int foreign key references major(id) #列级约束外键，但是不支持（5.7版本后认为foreign key 错误语法）
    
#表级约束语法
#[constraint 约束名] 约束类型（字段名），约束名不能重复
    


constraint ck check(gender='男'or gender='女')#设置表级检查
constraint fk_stuinfo_major foreign key(majorid) references major(id)#表级外键 
```

#### 修改表时添加

```mysql
#1.添加列级约束
alter table 表名 modify column 字段名 字段类型 新约束
#添加表级约束
alter table 表名 add [constraint 约束名] 约束类型（字段名） [外键的引用]

#1.添加非空约束
alter table stuinfo modify column stuname varchar(20) not null
#2.添加默认约束
alter table stuinfo modify column age int default 18
#3.添加主键
	# 列级约束
	alter table stuinfo modify column id int primary key;
	#表级约束
	1.alter table stuinfo modify column key(id);
	2.alter table stuinfo add constraint 添加约束的列，起的名字(别名) primary key(需要添加约束的列)
	
#4.添加唯一
	#1.列级约束
	alter table stuinfo modify column seat int unique;
	#2.表级约束
	alter table stuinfo add unique(seat);
#5.添加外键
alter table stuinfo add foreign key(majorid) references major(id)
（#向表stuinfo添加列dept_id,并在其中定义foreign key 约束，与之相关联的列是stu表中的id列
alter table stuinfo add constraint fk_stuinfo_stu foreign key(dept_id) references stu(id)
#主要是注意那个表，用谁的列，应该用在那个关键词后边）	
```

*   修改表删除约束

    ```mysql
    #1.删除非空约束
    alter table stuinfo modify column stuname varchar(20)  null
    #2.删除默认约束
    alter table stuinfo modify column age int
    #3.删除主键
    	# 列级约束
    	alter table stuinfo drop primary key;
    #4.删除唯一
    	#1.列级约束
    	alter table stuinfo drop index 唯一键名；
    #5.删除外键
    alter table stuinfo drop foreign key 外键约束名
    ```

## 自动增长

```mysql
介绍
	如果某一列是数值类型的， 使用 auto_increment 可以完成自动增长
添加
	# 创建表的时候添加
    create table stu (
        name varChar(20) primary auto_increment;
    )
    # 创建只有添加
    alter table stu modify name varchar(20) primary key auto_increment;
删除
alter table stu modify id int;
```

