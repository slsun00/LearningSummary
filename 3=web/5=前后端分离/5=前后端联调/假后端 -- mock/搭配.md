## mockjs + mock-server

### 介绍

```java
1.  mock 是完全基于webpack-dev-serve来实现的，所以在你启动前端服务的同时，mock-server就会自动启动
2. 通过 chokidar 来观察 mock 文件夹内容的变化
3. 在发生变化时会清除之前注册的mock-api接口，重新动态挂载新的接口，从而支持热更新
4. 是一个真正的server，所以你可以通过控制台中的network，清楚的知道接口返回的数据结构。并且同时解决了之前mockjs会重写 XMLHttpRequest对象，导致很多第三方库失效的问题。    
```

### 搭配结构

### 移除

```java
移除 mock-server
    // 只要在vue.config.js中
    移除webpack-dev-server中proxy和after这个Middleware就可以了。
    
    
proxy: {
  // change xxx-api/login => mock/login
  // detail: https://cli.vuejs.org/config/#devserver-proxy
  [process.env.VUE_APP_BASE_API]: {
    target: `http://localhost:${port}/mock`,
    changeOrigin: true,
    pathRewrite: {
      ['^' + process.env.VUE_APP_BASE_API]: ''
    }
  }
},
after: require('./mock/mock-server.js')    
```

#### mockjs

```java

// src/main.js 中
import { mockXHR } from '../mock'
if (process.env.NODE_ENV === 'production') {
  mockXHR()
}
```

### 新增

## 案例 =======

```java
role
    index.js
    routes.js
article.js
index.js
mock-serve.js
remote-server.js
user.js
utils.js    
```

### utils

```java
utils.js
    param2Obj()
    deepClone()
    module.exports = {
        param2Obj()  // 参数转对象
        deepClone()  // 
    }

```

### api

```java
user.js
    tokens:{}
	users: {
        'admin-token':{}
        'editor-token':{}
    }
	module.exports = {
        // 各种请求
        {/vue-element-admin/user/login}
        {get user info}
        {user logout}
    }


// article.js
	require('mock')
	module.exports = {
        // 各种请求
        {'/vue-element-admin/article/list'}
        {'/vue-element-admin/article/detail'}
        {'/vue-element-admin/article/pv'}
        {'/vue-element-admin/article/create'}
        {'/vue-element-admin/article/update'}
    }   
```



### indx.js

```java
require
    mock
    utils>param2obj 
    api>进行url解构
 mockXHR(){
    
}
	    
```

