# json 对象

## 创建

### 介绍

```java
创建
    // 方式一
    只需使用 JSONObject（fastJson提供的json对象） 和 JSONArray（fastJson提供json数组对象） 对象即可。
    // 方拾二
    String json = "{\"id\":\"2\",\"name\":\"Json技术\"}";
	String json = "[{\"id\":\"1\",\"name\":\"Json技术\"},{\"id\":\"2\",\"name\":\"java技术\"}]";
    
理解   
	JSONObject 
    	// 实现了 map
        可以把当成一个 Map<String,Object> 来看，
	    只是 JSONObject 提供了更为丰富便捷的方法，方便我们对于对象属性的操作。
     JSONArray 
    	// 实现了 list
    	当做一个 List<Object>，可以把 JSONArray 看成 JSONObject 对象的一个集合。
    	

 
注意
    由于 JSONObject 和 JSONArray 继承了 JSON，所以说也可以直接使用两者对 JSON 格式字符串与 JSON 对象及 javaBean 之间做转换，不过为了避免混淆我们还是使用 JSON。
```

### 例子

```java

        JSONObject jsonObject = new JSONObject();
        jsonObject.put("AGE", 10);
        jsonObject.put("FULL NAME", "Doe " + i);
        jsonObject.put("DATE OF BIRTH", "2016/12/12 12:12:12");

		JSONArray jsonArray = new JSONArray();
        jsonArray.add(jsonObject);

    String jsonOutput = jsonArray.toJSONString();

// 结果
[
   {
      "AGE":"10",
      "DATE OF BIRTH":"2016/12/12 12:12:12",
      "FULL NAME":"Doe 0"
   }
]    
```

## 操作

```java
String propertyName = 'id';
String propertyValue = "";
String json = "{\"id\":\"1\",\"name\":\"Json技术\"}";
JSONObject obj = JSON.parseObject(json);
propertyValue = obj.get(propertyName));

```

## 转换配置

#### ContextValueFilter 

##### 介绍

```java
介绍
    在某些场景下，对Value做过滤，需要获得所属JavaBean的信息，包括类型、字段、方法等。
    在fastjson-1.2.9中，提供了ContextValueFilter，
    类似于之前版本提供的ValueFilter，只是多了BeanContext参数可用。
```

##### 例子

```java
    ContextValueFilter valueFilter = new ContextValueFilter () {
        public Object process(
          BeanContext context, Object object, String name, Object value) {
            if (name.equals("DATE OF BIRTH")) {
                return "NOT TO DISCLOSE";
            }
            if (value.equals("John")) {
                return ((String) value).toUpperCase();
            } else {
                return null;
            }
        }
    };
	// 对要转化的对象 listOfPersons 使用
    String jsonOutput = JSON.toJSONString(listOfPersons, valueFilter);

结果
//隐藏了 DATE OF BIRTH 字段，并过滤名字不包含 John 的字段
[
    {
        "FULL NAME":"JOHN DOE",
        "DATE OF BIRTH":"NOT TO DISCLOSE"
    }
]
```

#### NameFilter 和 SerializeConfig

##### 例子

```java
// 声明了 formatName 过滤器使用 NameFilter 匿名类来处理字段名称    
NameFilter formatName = new NameFilter() {
        public String process(Object object, String name, Object value) {
            return name.toLowerCase().replace(" ", "_");
        }
    };
     
    // 新创建的过滤器与 Person 类相关联，然后添加到全局实例，它是 SerializeConfig 类中的静态属性。
    SerializeConfig.getGlobalInstance().addFilter(Person.class,  formatName);

	// 使用的是 toJSONStringWithDateFormat() 而不是 toJSONString() ，它可以更快速的格式化日期
    String jsonOutput =
      JSON.toJSONStringWithDateFormat(listOfPersons, "yyyy-MM-dd");
}
```





# java bean转 json

## 注解

### jsonfiled

#### 详解

```java
介绍
    使用 @JSONField 注解，以便实现自定义转换
    
作用对象
    1. Field
    2. Setter 和 Getter 方法
注意
    1. FastJson 在进行操作时，是根据 getter 和 setter 的方法进行的，并不是依据 Field 进行。
    2. 属性是私有的，必须有 set 方法。否则无法反序列化。
    
相关属性
    name： json 化后在 json 字符串中的属性名
    serialize ： 是否序列化 Java bean 实体
    ordinal 参数指定字段的顺序
    format: 日期格式化， 1.1.42 以上版本
```

#### 例子

```java

public class Person {
     
    @JSONField(name="AGE", serialize=false)
    private int age;

    @JSONField(name="LAST NAME", ordinal = 2)
    private String lastName;
 
    @JSONField(name="DATE OF BIRTH", format="dd/MM/yyyy", ordinal = 3)
    private Date dateOfBirth;
 	
    // get set 方法上
      private int id;
 
      @JSONField(name="ID")
      public int getId() {return id;}
      @JSONField(name="ID")
      public void setId(int value) {this.id = id;}
    
    public Person(int age, String fullName, Date dateOfBirth) {
        super();
        this.age = age;
        this.fullName= fullName;
        this.dateOfBirth = dateOfBirth;
    }
 
    // 标准 getters & setters
}

// 结果为
    {
        "AGE":"18",
        "LAST NAME":"Jhon",
        "DATE OF BIRTH":"19/07/2016"
    },
```



## 硬编码

### JSON.toJSONString()

```java
介绍
    可以使用 JSON.toJSONString() 将 Java 对象转换换为 JSON 对象：
使用
// 基础 bean
    // 将对象转换成格式化的json
    JSON.toJSONString(obj, true);
    // 将对象转换成非格式化的json
    JSON.toJSONString(obj, false);
// 集合 bean
	// 对于重复的引用在转成json串后在json串中出现引用的字符,
	// 比如 //  $ref":"$[0].books[1]

    Student stu = new Student();
    Set books= new HashSet();
    Book book = new Book();
    books.add(book);
    stu.setBooks(books);
    List list = new ArrayList();
    for(int i=0;i<5;i++) {
        list.add(stu);
    }
    String json = JSON.toJSONString(list, true);
    // ==================	
    private List<Person> listOfPersons = new ArrayList<Person>();
	listOfPersons.add(new Person(15, "John Doe", new Date()));
	String jsonOutput= JSON.toJSONString(listOfPersons);
```

# JSON 转 bean

## 硬编码

### parseObject

#### 介绍

```java
介绍
    可以使用 JSON.parseObject() 将 JSON 字符串转换为 Java 对象
注意
    1. 注意反序列化时为对象时，必须要有默认无参的构造函数，否则会报异常
    2. @JSONField deserialize 可选项可以指定字段不反序列化
    	// 解析的字符串中 dateOfBirth 就是 null
    	@JSONField(name = "DATE OF BIRTH", deserialize=false)
        private Date dateOfBirth;
```

#### 例子

```java
// 基础 bean
    
	Person person = new Person(20, "John", "Doe", new Date());
    String jsonObject = JSON.toJSONString(person);
    Person newPerson = JSON.parseObject(jsonObject, Person.class);
// 集合 bean (List，Map)
    String json = "[{\"id\":\"1\",\"name\":\"Json技术\"},{\"id\":\"2\",\"name\":\"java技术\"}]";
    // 将json转换成List
    List list = JSON.parseObject(json, new TypeReference<ARRAYLIST>(){});
    // 将json转换成Set
    Set set = JSON.parseObject(json, new TypeReference<HASHSET>(){});


```



## == BeanToArray ==


