



## 整合-SpringMVC

### tomcat

```yml
介绍
    可以修改tomcat的端口和访问项目中的静态资源
使用步骤
1. 位置
    spring-boot-autoconfigure... --> org --> springframework --> 
    boot -->autoconfigure --> web --> ServerProperties
    
2. 修改 tomcat 端口
    application.yml 中添加
    	# 查询 Properties，设置配置项（前缀+类变量名）到application配置文件中
        #tomcat端口
        server:
          port: 80
    
3. 静态资源
	# 查询 Properties，静态资源放置的位置, resourceProperties 中有规定
	
	# 介绍， 静态资源放在这些目录中任何一个，SpringMVC都会帮我们处理。 
        classpath:/META-INF/resources/
        classpath:/resources/
        classpath:/static/
        classpath:/public
    
	文件目录： main/resources/static
    放置静态资源并访问这些资源
```

### 日志

```java
// 配置
logging:
    level:
        com.itheima: debug
        org.springframework: info

```



### SpringMVC拦截器

#### 介绍

```java
介绍
    可以在Spring Boot项目中配置自定义SpringMVC拦截器（一个类）
实现
   1. 编写拦截器（实现HandlerInterceptor）；
   2. 编写配置类实现 WebMvcConfigurer，在该类中添加各种组件； 
    
```

#### java

```java
// 可以在spring boot项目中通过配置类添加各种组件；如果要添加拦截器的话：
package com.itheima.config;

import com.itheima.interceptor.MyInterceptor;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.InterceptorRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

@Configuration
public class MvcConfig implements WebMvcConfigurer {

    //注册拦截器
    @Bean
    public MyInterceptor myInterceptor(){
        return new MyInterceptor();
    }

    //添加拦截器到spring mvc拦截器链
    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(myInterceptor()).addPathPatterns("/*");
    }
}

```



## 整合-Mybatis

```java
介绍
	SpringBoot官方并没有提供Mybatis的启动器，不过Mybatis官网自己实现了。    
```

### 配置

```xml
mybatis:
  # 实体类别名包路径
  type-aliases-package: com.itheima.pojo
  # 映射文件路径
  # mapper-locations: classpath:mappers/*.xml
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
```

### java

```java
// 这里没有配置mapper接口扫描包，
// 因此我们需要给每一个Mapper接口添加 @Mapper 注解，才能被识别。
@Mapper public interface UserMapper { 
}

// 不加注解，而是在启动类上添加扫描包注解(推荐)
// 启动引导类，是工程的入口
@SpringBootApplication 
@MapperScan("com.itheima.mapper") 
public class Application { 
    public static void main(String[] args) { 
    // 启动代码 
        SpringApplication.run(Application.class, args); 
    }
}
```

### 整合-通用Mapper

#### 介绍

```java
介绍
    配置通用Mapper组件到Spring Boot项目中并使用Mapper<T>接口
作用
    以实现自动拼接sql语句；
    所有的mapper都不需要编写任何方法也就是不用编写sql语句。
    可以提高开发效率。
注意
    一旦引入了通用Mapper的启动器，会覆盖Mybatis官方启动器的功能，
    因此需要移除对官方Mybatis启动器的依赖。
    
方法
    // 在启动引导类上面的mapper扫描注解 一定要修改为 通用mapper的扫描注解
   1. 添加启动器依赖；
    2. 改造UserMapper继承Mapper<User>；
    3. 修改启动引导类Application中的Mapper扫描注解；
    4. 修改User实体类添加jpa注解；
    5. 改造UserService实现业务功能；
```

#### java

```java
// \com\itheima\mapper\UserMapper.java 
// 通用 mapper
import com.itheima.pojo.User; 
import tk.mybatis.mapper.common.Mapper; 
public interface UserMapper extends Mapper<User> {
}

// \com\itheima\Application.java
// 启动引导类
import tk . mybatis . spring. annotation. MapperScan;导入的包是tk开头的
@SpringBootApplication    
@MapperScan("com.itheima.mapper")
pub1ic class ApPlication {
	public static void main(string[] args) { 
        SpringApplication.run (Application.class，args) ;
    }
}    

// com.itheima/pojo/User.java
// 实体类
@Data 
@Table(name = "tb_user") 
public class User{ 
    // id 
    @Id 
    //开启主键自动回填 
    @KeySql(useGeneratedKeys = true) 
    private Long id;
    
    // 用户名， 字段名和属性名一致，就不用添加，符合驼峰规则 
    // @Column(name = "abc")
    private String userName; 
    // 密码 
    private String password;
}


// 查询
@Service 
public class UserService { 
    @Autowired 
    private UserMapper userMapper; 
    public User queryById(Long id){ 
        //根据id查询 
        return userMapper.selectByPrimaryKey(id); 
    }
    @Transactional 
    public void saveUser(User user){ 
        System.out.println("新增用户..."); 
        userMapper.insertSelective(user); 
    }
}

// 测试
// 可以访问处理器对应路径将数据库中的数据根据id查询
// 启动项目进行测试 http://localhost/user/用户id --> http://localhost/user/8
@RestController 
public class HelloController { 
    @Autowired 
    private UserService userService;
    /*** 根据id获取用户 
    * @param id 用户id 
    * @return 用户 
    */
    @GetMapping("/user/{id}")
    public User queryById(@PathVariable Long id){ 
        return userService.queryById(id); 
    } 
}
```



## 整合-Junit

### 介绍

```java
介绍
    在Spring Boot项目中使用Junit进行单元测试UserService的方法
    
注意
    在Spring Boot项目中如果编写测试类则必须要在类上面添加@SpringBootTest
    
方法
    1. 添加启动器依赖spring-boot-starter-test；
	2. 编写测试类
```



### 项目配置 pom.xml

```xml
<dependency> 
    <groupId>org.springframework.boot</groupId> 
    <artifactId>spring-boot-starter-test</artifactId> 
</dependency>
```

### 使用

```java
// 位置 java/com/itheima/service/UserServiceTest.java
@RunWith(SpringRunner.class)
@SpringBootTest
public class UserServiceTest {

    @Autowired
    private UserService userService;

    @Test
    public void queryById() {
        User user = userService.queryById(8L);
        System.out.println("user = " + user);
    }

    @Test
    public void saveUser() {
        User user = new User();
        user.setUserName("test2");
        user.setName("test2");
        user.setAge(13);
        user.setPassword("123456");
        user.setSex(1);
        user.setCreated(new Date());
        userService.saveUser(user);
    }
}
```



## 整合-redis

### 介绍

```java
介绍
    在Spring Boot项目中使用Junit测试RedisTemplate的使用
步骤
    1. 添加启动器依赖；spring-boot-starter-data-redis
	2. 配置application.yml中修改redis的连接参数；（redis需要启动）
	3. 编写测试类应用RedisTemplate操作redis中的5种数据类型（string/hash/list/set/sorted set）
```

### 项目配置 - pom.xml

```xml
<!--启动器配置-->
<dependency> 
    <groupId>org.springframework.boot</groupId> 
    <artifactId>spring-boot-starter-data-redis</artifactId> 
</dependency>
```

### 其他配置

```java
// application.yml 
spring: 
	redis: 
		host: localhost 
         port: 6379
```

### java 代码

```java
@RunWith(SpringRunner.class)
@SpringBootTest
public class RedisTest {

    @Autowired
    private RedisTemplate redisTemplate;

    @Test
    public void test(){
        //string 字符串
        //redisTemplate.opsForValue().set("str", "heima");
        redisTemplate.boundValueOps("str").set("heima");
        System.out.println("str = " + redisTemplate.opsForValue().get("str"));

        //hash 散列
        redisTemplate.boundHashOps("h_key").put("name", "heima");
        redisTemplate.boundHashOps("h_key").put("age", 13);
        //获取所有域
        Set set = redisTemplate.boundHashOps("h_key").keys();
        System.out.println(" hash散列的所有域：" + set);
        //获取所有值
        List list = redisTemplate.boundHashOps("h_key").values();
        System.out.println(" hash散列的所有域的值：" + list);

        //list 列表
        redisTemplate.boundListOps("l_key").leftPush("c");
        redisTemplate.boundListOps("l_key").leftPush("b");
        redisTemplate.boundListOps("l_key").leftPush("a");
        //获取全部元素
        list = redisTemplate.boundListOps("l_key").range(0, -1);
        System.out.println(" list列表中的所有元素：" + list);

        // set 集合
        redisTemplate.boundSetOps("s_key").add("a", "b", "c");
        set = redisTemplate.boundSetOps("s_key").members();
        System.out.println(" set集合中的所有元素：" + set);

        // sorted set 有序集合
        redisTemplate.boundZSetOps("z_key").add("a", 30);
        redisTemplate.boundZSetOps("z_key").add("b", 20);
        redisTemplate.boundZSetOps("z_key").add("c", 10);
        set = redisTemplate.boundZSetOps("z_key").range(0, -1);
        System.out.println(" zset有序集合中的所有元素：" + set);
    }
}

```



## 项目部署

### 介绍

```java
介绍
    将Spring Boot项目使用maven指令打成jar包并运行测试
步骤
    1. 需要添加打包组件
    	将项目中的资源、配置、依赖包打到一个jar包中；可以使用maven的`package`；
	2. 部署：
    	java -jar 包名
```



### 打包组件 pom.xml

```xml
    <build>
        <plugins>
           <!-- 打jar包时如果不配置该插件，打出来的jar包没有清单文件 -->
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>

// 注意
IDEA 右侧，会有一个 maven 的侧边栏，选择进行打包
注意要跳过测试
```



### 部署运行

```sh
// cmd 中运行
java -jar 包名
```

