## 策略模式

* Strategy Pattern 

* 别称
    *  政策模式(Policy)
        *  让算法独立于使用它的客户而变化 

* 一系列算法，将每一个算法封装起来，并让它们可以相互替换，让算法独立于使用它的客户而变化 。 

* 策略(Strategy) 

    *  每一个封装算法的类 

* 为了解决在有多种算法相似的情况下，使用if…else所带来的复杂和难以维护性，这样定义一系列的算法，把它们一个个封装起来，并且使它们相互替换。 

* 是对算法的封装，它把算法的责任和算法本身分割开，委派给不同的对象管理 

* 把一个系列的算法封装到一系列的策略类里面，作为一个抽象策略类的子类。用一句话来说，就是“准备一组算法，并将每一个算法封装起来，使得它们可以互换”。 

* 应当由客户端自己决定在什么情况下使用什么具体策略角色。 

* 仅仅封装算法，提供新算法插入到已有系统中，以及老算法从系统中“退休”的方便，策略模式并不决定在何时使用何种算法，算法的选择由客户端来决定。 

   

## 评价

### 优点

*  提供了对“开闭原则”的完美支持，用户可以在不修改原有系统的基础上选择算法或行为，也可以灵活地增加新的算法或行为。 
*  提供了管理相关的算法族的办法 
*  提供了可以替换继承关系的办法。 
*  可以避免使用多重条件转移语句。 

### 缺点

* 客户端必须知道所有的策略类，需要理解所有具体策略类之间的区别，以便选择合适的算法，并自行决定使用哪一个策略类。
* 策略模式将造成产生很多策略类，可以通过使用享元模式在一定程度上减少对象的数量。

## 适用环境

- 如果在一个系统里面有许多类，它们之间的区别仅在于它们的行为，那么使用策略模式可以动态地让一个对象在许多行为中选择一种行为。
- 一个系统需要动态地在几种算法中选择一种。
- 如果一个对象有很多的行为，如果不用恰当的模式，这些行为就只好使用多重的条件选择语句来实现。
- 不希望客户端知道复杂的、与算法相关的数据结构，在具体策略类中封装算法和相关的数据结构，提高算法的保密性与安全性

## 模式结构

```go
Strategy  抽象策略类
	所有策略类的父类，为所支持的策略算法声明了抽象方法，可以为接口
ConcreteStrategy: 	具体策略类
	实现了在抽象策略类中声明的方法
context	 环境类
	负责使用算法策略，其中维持了一个抽象策略类的引用实例
```

### 通俗理解

```js
Strategy    			 付款功能						interface
ConcreteStrategy		 支付宝、微信、京东				  struct
----------------------------------------------------------------------------
context    			     你使用选择一种方式进行付款		    选择不同的类型

// 自己的理解
strategy  		 有种功能 a
concreteStrategy  各个实例都有这个功能 
context 		 这里就是你，挑选一个实例，执行 a 功能，就会自动调用你选择的实例的功能（注意这个自动调用，看代码）
补充：
	1. 可以理解为前两个已经存在了，你只是在使用 a 功能的时候，挑选不同的具体策略
    2. 传入的是一个结构体实例 , 相当于接收一个整体
    3. 不要过分注意 context 的中文翻译，你晓得它的具体使用含义就行
```

## demo

```go
// 类型创建，可以使用工厂模式，为了力求简单明了，就不设置工厂模式了

type PayMoney interface{
    pay()
}

type WeiXin struct{}
func (w *WeiXin) pay(){}

type  ZhiFuBao struct{}
func (z *ZhiFuBao) pay() {}

// 这个地方注意为什么可以使用 interface ,但是传递的是结构体 ？
// 一个自定义类型实现了一个接口 ，那么这个类型就可以转化为对应的 interface 对象
type User struct(){
    paystyle PayMoney
}

func (u *User) pay(){
    // 自动调用
    u.paystyle.pay()
}

func NewUser(paymoney PayMoney) *User {
    return &User{paymoney}
}

func main(){
    // 传进来的是一个结构体
    user := NewUser(new(WeiXin))
	// 可以自动调用你选择的付款方式的 pay
    user.pay()
}

```

## 相关图示

![image-20201213201856230](image-20201213201856230.png)











































































































